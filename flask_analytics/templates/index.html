{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-3">
        <div class="stat-card bg-primary">
            <h3>{{ stats.total_books or 0 }}</h3>
            <p>–ö–Ω–∏–≥ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card bg-success">
            <h3>{{ stats.total_orders or 0 }}</h3>
            <p>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card bg-info">
            <h3>{{ stats.total_users or 0 }}</h3>
            <p>–ö–ª–∏–µ–Ω—Ç–æ–≤</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card bg-warning text-dark">
            <h3>{{ "%.2f"|format(stats.total_revenue|float|default(0)) }} ‚ÇΩ</h3>
            <p>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</p>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã
                <a href="/orders" class="btn btn-sm btn-primary float-end">–í—Å–µ –∑–∞–∫–∞–∑—ã</a>
            </div>
            <div class="card-body">
                {% if recent_orders %}
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ö–ª–∏–µ–Ω—Ç</th>
                                <th>–°—É–º–º–∞</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in recent_orders %}
                            <tr>
                                <td>#{{ order.id }}</td>
                                <td>{{ order.created|dateformat }}</td>  <!-- –ò–°–ü–†–ê–í–õ–ï–ù–û -->
                                <td>{{ order.username or '–ì–æ—Å—Ç—å' }}</td>
                                <td>{{ "%.2f"|format(order.total|float|default(0)) }} ‚ÇΩ</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted text-center">–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                –¢–æ–ø –∫–Ω–∏–≥ –ø–æ –Ω–∞–ª–∏—á–∏—é
                <a href="/books" class="btn btn-sm btn-primary float-end">–í—Å–µ –∫–Ω–∏–≥–∏</a>
            </div>
            <div class="card-body">
                {% if top_books %}
                <div class="list-group">
                    {% for book in top_books %}
                    <div class="list-group-item">
                        <div class="d-flex justify-content-between">
                            <div>
                                <strong>{{ book.title[:30] }}{% if book.title|length > 30 %}...{% endif %}</strong>
                                <div class="text-muted small">{{ book.authors }}</div>
                            </div>
                            <div class="text-end">
                                <div>{{ "%.2f"|format(book.price|float|default(0)) }} ‚ÇΩ</div>
                                <span class="badge bg-{% if book.stock > 10 %}success{% elif book.stock > 0 %}warning{% else %}danger{% endif %}">
                                    {{ book.stock }} —à—Ç.
                                </span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–Ω–∏–≥–∞—Ö</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
            </div>
            <div class="card-body text-center">
                <div class="btn-group flex-wrap">
                    <a href="/books" class="btn btn-outline-primary m-1">üìö –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–Ω–∏–≥</a>
                    <a href="/orders" class="btn btn-outline-success m-1">üõí –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤</a>
                    <a href="/customers" class="btn btn-outline-info m-1">üë• –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–ª–∏–µ–Ω—Ç–æ–≤</a>
                    <a href="/analytics" class="btn btn-outline-warning m-1">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
                    <a href="/export/books/csv" class="btn btn-outline-secondary m-1">üì• –≠–∫—Å–ø–æ—Ä—Ç –∫–Ω–∏–≥</a>
                    <a href="/export/orders/csv" class="btn btn-outline-secondary m-1">üì• –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-header">
        –û —Å–∏—Å—Ç–µ–º–µ
    </div>
    <div class="card-body">
        <p>–î–∞–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–∂–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞.</p>
        <p><strong>–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:</strong></p>
        <ul>
            <li>–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ –∫–Ω–∏–≥</li>
            <li>–ê–Ω–∞–ª–∏–∑ –∑–∞–∫–∞–∑–æ–≤ –∏ –ø—Ä–æ–¥–∞–∂</li>
            <li>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑–æ–π</li>
            <li>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV —Ñ–æ—Ä–º–∞—Ç–µ</li>
            <li>–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º —Å–∏—Å—Ç–µ–º—ã</li>
        </ul>
    </div>
</div>
{% endblock %}